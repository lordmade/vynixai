<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />
  <title>Kids Coloring Book</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    body {
      min-height: 100dvh;
      margin: 0;
      touch-action: manipulation;
      position: fixed;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    canvas {
      touch-action: none;
      background: white;
      border-radius: 1rem;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }
    .crayon {
      transition: all 0.2s;
      min-width: 60px;
      min-height: 60px;
      width: clamp(60px, 15vw, 80px);
      height: clamp(60px, 15vw, 80px);
    }
    .crayon:active {
      transform: scale(0.9);
    }
    .selected {
      box-shadow: 0 0 0 4px white, 0 0 0 8px #333;
    }
    .page-indicator {
      animation: bounce 2s infinite;
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .celebration {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      font-size: 4rem;
      z-index: 1000;
      animation: pop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
    }
    @keyframes pop {
      to { transform: translate(-50%, -50%) scale(1.5); opacity: 0; }
    }
  </style>
</head>
<body class="flex flex-col items-center justify-center">

  <!-- Page Title -->
  <div class="page-indicator text-white text-2xl font-bold mb-4">
    <span id="pageName">Cat</span>
  </div>

  <!-- Canvas -->
  <canvas id="canvas" class="w-11/12 max-w-md aspect-square mb-6"></canvas>

  <!-- Color Palette -->
  <div class="flex flex-wrap justify-center gap-3 mb-6">
    <button class="crayon rounded-full border-4 border-white selected" data-color="#ff1493" style="background:#ff1493"></button>
    <button class="crayon rounded-full border-4 border-white" data-color="#ff6bcb" style="background:#ff6bcb"></button>
    <button class="crayon rounded-full border-4 border-white" data-color="#ff9d00" style="background:#ff9d00"></button>
    <button class="crayon rounded-full border-4 border-white" data-color="#ffed4e" style="background:#ffed4e"></button>
    <button class="crayon rounded-full border-4 border-white" data-color="#4eff7b" style="background:#4eff7b"></button>
    <button class="crayon rounded-full border-4 border-white" data-color="#4e9fff" style="background:#4e9fff"></button>
    <button class="crayon rounded-full border-4 border-white" data-color="#9c4eff" style="background:#9c4eff"></button>
    <button class="crayon rounded-full border-4 border-white" data-color="#000" style="background:#000"></button>
  </div>

  <!-- Controls -->
  <div class="flex gap-4 flex-wrap justify-center mb-4">
    <button id="prevBtn" class="px-6 py-3 bg-gray-500 text-white rounded-xl font-bold shadow-lg">‚Üê Previous</button>
    <button id="nextBtn" class="px-6 py-3 bg-green-500 text-white rounded-xl font-bold shadow-lg">Next ‚Üí</button>
    <button id="clearBtn" class="px-6 py-3 bg-red-500 text-white rounded-xl font-bold shadow-lg">Clear</button>
  </div>

  <script>
    // Coloring pages data
    const pages = [
      { name: "Cat", path: "M50 20 Q30 20 20 40 Q15 60 30 80 Q40 90 60 90 Q80 90 90 80 Q105 60 100 40 Q90 20 70 20 Q60 15 50 20 M60 30 Q70 30 75 35 Q80 40 75 45 Q70 50 60 50 Q50 50 45 45 Q40 40 45 35 Q50 30 60 30 M40 60 Q50 70 60 60 Q70 50 80 60 Q85 70 80 75 Q70 80 60 75 Q50 80 40 75 Q35 70 40 60 M30 40 Q20 50 30 60 M70 40 Q80 50 70 60" },
      { name: "House", path: "M50 20 L20 50 L20 80 L80 80 L80 50 Z M40 60 L40 80 M60 60 L60 80 M30 70 L50 70 M50 60 L50 80 M70 70 L50 70 M35 40 L35 50 L45 50 L45 40 Z M55 40 L55 50 L65 50 L65 40 Z" },
      { name: "Star", path: "M50 15 L58 35 L80 35 L63 50 L70 70 L50 55 L30 70 L37 50 L20 35 L42 35 Z" },
      { name: "Fish", path: "M30 50 Q20 40 20 50 Q20 60 30 50 Q50 45 70 50 Q90 55 100 50 Q90 45 70 50 Q50 55 30 50 M70 45 Q75 40 80 45 M70 55 Q75 60 80 55" },
      { name: "Flower", path: "M50 70 Q30 70 30 50 Q30 30 50 30 Q70 30 70 50 Q70 70 50 70 M50 30 L50 15 M35 35 L25 25 M65 35 L75 25 M35 65 L25 75 M65 65 L75 75 M40 50 L25 50 M60 50 L75 50 M50 40 L50 25 M50 60 L50 75" }
    ];

    let currentPage = 0;
    let color = '#ff1493';
    let isDrawing = false;
    let undoStack = [];

    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    // Resize canvas
    const resizeCanvas = () => {
      const rect = canvas.getBoundingClientRect();
      canvas.width = rect.width * devicePixelRatio;
      canvas.height = rect.height * devicePixelRatio;
      ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, 0, 0);
      drawOutline();
    };
    window.addEventListener('resize', resizeCanvas);

    // Draw outline
    const drawOutline = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 3;
      ctx.lineCap = 'round';
      
      const scale = canvas.width / 100 / devicePixelRatio;
      ctx.save();
      ctx.scale(scale, scale);
      
      const path = new Path2D(pages[currentPage].path);
      ctx.stroke(path);
      ctx.restore();
    };

    // Load page
    const loadPage = () => {
      drawOutline();
      document.getElementById('pageName').textContent = pages[currentPage].name;
      undoStack = [];
    };

    // Color selection
    document.querySelectorAll('.crayon').forEach(button => {
      button.addEventListener('click', () => {
        document.querySelectorAll('.crayon').forEach(b => b.classList.remove('selected'));
        button.classList.add('selected');
        color = button.dataset.color;
      });
    });

    // Drawing
    const startDraw = (e) => {
      isDrawing = true;
      const rect = canvas.getBoundingClientRect();
      const touch = e.touches ? e.touches[0] : e;
      ctx.beginPath();
      ctx.moveTo(touch.clientX - rect.left, touch.clientY - rect.top);
    };

    const draw = (e) => {
      if (!isDrawing) return;
      e.preventDefault();
      const rect = canvas.getBoundingClientRect();
      const touch = e.touches ? e.touches[0] : e;
      ctx.lineWidth = 8;
      ctx.lineCap = 'round';
      ctx.strokeStyle = color;
      ctx.lineTo(touch.clientX - rect.left, touch.clientY - rect.top);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(touch.clientX - rect.left, touch.clientY - rect.top);
    };

    const stopDraw = () => {
      if (isDrawing) {
        isDrawing = false;
        undoStack.push(canvas.toDataURL());
        if (undoStack.length > 10) undoStack.shift();
      }
    };

    // Touch events
    canvas.addEventListener('touchstart', startDraw, {passive: true});
    canvas.addEventListener('touchmove', draw, {passive: false});
    canvas.addEventListener('touchend', stopDraw);

    // Mouse events (desktop)
    canvas.addEventListener('mousedown', startDraw);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDraw);

    // Navigation
    const celebrate = () => {
      const confetti = document.createElement('div');
      confetti.className = 'celebration';
      confetti.textContent = 'üéâ';
      document.body.appendChild(confetti);
      setTimeout(() => confetti.remove(), 600);
    };

    document.getElementById('nextBtn').addEventListener('click', () => {
      currentPage = (currentPage + 1) % pages.length;
      loadPage();
      celebrate();
    });

    document.getElementById('prevBtn').addEventListener('click', () => {
      currentPage = (currentPage - 1 + pages.length) % pages.length;
      loadPage();
    });

    // Controls
    document.getElementById('clearBtn').addEventListener('click', () => {
      drawOutline();
      undoStack = [];
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') document.getElementById('prevBtn').click();
      if (e.key === 'ArrowRight') document.getElementById('nextBtn').click();
    });

    // Initialize
    loadPage();
  </script>
</body>
</html>
