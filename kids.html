<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>AlphaPal • Phonics ABC!</title>

  <!-- PWA -->
  <link rel="manifest" href="data:application/manifest+json,{
    \"name\":\"AlphaPal – Phonics ABC\",
    \"short_name\":\"AlphaPal\",
    \"description\":\"Sing, sound & write the alphabet!\",
    \"start_url\":\"./kids.html\",
    \"display\":\"standalone\",
    \"background_color\":\"#fff0f8\",
    \"theme_color\":\"#ff6bcb\",
    \"icons\":[
      {\"src\":\"https://api.dicebear.com/7.x/shapes/svg?seed=AlphaPal&backgroundColor=ff6bcb&size=192\",\"sizes\":\"192x192\",\"type\":\"image/svg+xml\"},
      {\"src\":\"https://api.dicebear.com/7.x/shapes/svg?seed=AlphaPal&backgroundColor=ff6bcb&size=512\",\"sizes\":\"512x512\",\"type\":\"image/svg+xml\"}
    ]
  }">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Comic+Neue:wght@700&display=swap" rel="stylesheet">

  <style>
    /* PREVENT LONG-PRESS HIGHLIGHT & CONTEXT MENU */
    *, *::before, *::after {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    button, canvas { outline: none; }
    img { pointer-events: none; }

    body { font-family: 'Comic Neue', cursive; background: linear-gradient(135deg, #fff0f8, #e0f9ff); margin:0; height:100dvh; overflow:hidden; }
    h1 { font-family: 'Fredoka One', cursive; }
    .rainbow { background: linear-gradient(90deg, #ff6bcb,#ffaecb,#a0e7ff,#9fffcb,#ffd580,#ff9f9f); -webkit-background-clip: text; color: transparent; }
    .sparkle { animation: sparkle 2s infinite; }
    @keyframes sparkle { 0%,100% { transform: scale(1) rotate(0); } 50% { transform: scale(1.15) rotate(5deg); } }
    .emoji-img { animation: float 3s infinite ease-in-out; filter: drop-shadow(0 15px 25px rgba(0,0,0,0.2)); }
    @keyframes float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

    #mobileNav {
      position: fixed; bottom: 0; left: 0; right: 0;
      background: linear-gradient(to top, rgba(255,255,255,0.95), rgba(255,255,255,0.8));
      backdrop-filter: blur(12px);
      padding: 12px 0;
      border-top: 4px solid #ff6bcb;
      box-shadow: 0 -10px 30px rgba(0,0,0,0.15);
      z-index: 50;
    }
    #desktopNav {
      position: fixed; left: 0; top: 0; bottom: 0; width: 140px;
      background: linear-gradient(to bottom, #ff9edd, #a0efff);
      display: flex; flex-direction: column; align-items: center;
      padding-top: 100px; gap: 30px;
      box-shadow: 10px 0 30px rgba(0,0,0,0.1);
      z-index: 40;
    }
    .nav-btn {
      width: 90px; height: 90px; border-radius: 50%; font-size: 36px;
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 8px 20px rgba(0,0,0,0.25);
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .nav-btn:active, .nav-btn.tapped {
      transform: scale(0.88) !important;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body class="flex flex-col">

  <!-- Header -->
  <div class="text-center py-6 bg-gradient-to-b from-pink-200 to-transparent relative z-30">
    <h1 class="text-6xl rainbow sparkle">AlphaPal</h1>
    <p class="text-3xl text-purple-700 mt-2">Phonics • Sing • Write</p>
  </div>

  <!-- Desktop Sidebar -->
  <div id="desktopNav" class="hidden lg:flex">
    <button id="soundBtnDesktop" class="nav-btn bg-gradient-to-br from-red-400 to-pink-500 text-white">Sound</button>
    <button id="singBtnDesktop" class="nav-btn bg-gradient-to-br from-purple-400 to-indigo-600 text-white">Sing</button>
    <button id="traceBtnDesktop" class="nav-btn bg-gradient-to-br from-green-400 to-teal-500 text-white">Write</button>
    <button id="nextBtnDesktop" class="nav-btn bg-gradient-to-br from-yellow-400 to-orange-500 text-white">Next</button>
  </div>

  <!-- Main Content -->
  <div id="main" class="flex-1 flex flex-col items-center justify-center gap-10 px-6 lg:pl-44 relative z-20 pb-32 lg:pb-10">
    <div id="letterDisplay" class="sparkle text-28vw md:text-24vw lg:text-20vw font-black text-center leading-none" style="color:hsl(0,90%,60%)">A</div>
    <div class="text-center">
      <div id="word" class="text-6xl md:text-8xl font-bold text-purple-800 mb-6 drop-shadow-lg">apple</div>
      <img id="image" src="" class="emoji-img w-64 h-64 md:w-80 md:h-80 mx-auto">
    </div>
  </div>

  <!-- Mobile Bottom Bar -->
  <div id="mobileNav" class="lg:hidden flex justify-around items-center">
    <button id="soundBtn" class="nav-btn bg-gradient-to-br from-red-400 to-pink-500 text-white">Sound</button>
    <button id="singBtn" class="nav-btn bg-gradient-to-br from-purple-400 to-indigo-600 text-white">Sing</button>
    <button id="traceBtn" class="nav-btn bg-gradient-to-br from-green-400 to-teal-500 text-white">Write</button>
    <button id="nextBtn" class="nav-btn bg-gradient-to-br from-yellow-400 to-orange-500 text-white">Next</button>
  </div>

  <!-- Tracing Screen -->
  <div id="traceScreen" class="hidden fixed inset-0 bg-gradient-to-br from-sky-300 via-pink-300 to-purple-300 flex flex-col items-center justify-center z-50">
    <canvas id="canvas" width="380" height="520" class="border-8 border-white rounded-3xl shadow-2xl bg-white/97"></canvas>
    <div class="mt-10 flex gap-10">
      <button id="clearBtn" class="px-14 py-7 bg-red-500 text-white text-4xl rounded-full shadow-2xl">Clear</button>
      <button id="backBtn" class="px-14 py-7 bg-purple-600 text-white text-4xl rounded-full shadow-2xl">Back</button>
    </div>
  </div>

  <!-- Sound Effects -->
  <audio id="pop" preload="auto" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3"></audio>
  <audio id="sparkleSound" preload="auto" src="https://assets.mixkit.co/sfx/preview/mixkit-magical-coin-win-1937.mp3"></audio>
  <audio id="click" preload="auto" src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3"></audio>

  <script>
    // Play sound
    function playSound(id) {
      const audio = document.getElementById(id);
      audio.currentTime = 0;
      audio.play().catch(() => {});
    }
    function tapEffect(btn) {
      btn.classList.add('tapped');
      setTimeout(() => btn.classList.remove('tapped'), 300);
    }

    const phonics = [
      {l:"A", sound:"ă", word:"apple", emoji:"1f34e"},
      {l:"B", sound:"b", word:"ball", emoji:"26bd"},
      {l:"C", sound:"k", word:"cat", emoji:"1f408"},
      {l:"D", sound:"d", word:"dog", emoji:"1f436"},
      {l:"E", sound:"ĕ", word:"elephant", emoji:"1f418"},
      {l:"F", sound:"f", word:"fish", emoji:"1f41f"},
      {l:"G", sound:"g", word:"giraffe", emoji:"1f992"},
      {l:"H", sound:"h", word:"hat", emoji:"1f3a9"},
      {l:"I", sound:"ĭ", word:"igloo", emoji:"1f6c4"},
      {l:"J", sound:"j", word:"jam", emoji:"1f370"},
      {l:"K", sound:"k", word:"kite", emoji:"1fa81"},
      {l:"L", sound:"l", word:"lion", emoji:"1f981"},
      {l:"M", sound:"m", word:"monkey", emoji:"1f412"},
      {l:"N", sound:"n", word:"nest", emoji:"1faba"},
      {l:"O", sound:"ŏ", word:"octopus", emoji:"1f419"},
      {l:"P", sound:"p", word:"penguin", emoji:"1f427"},
      {l:"Q", sound:"kw", word:"queen", emoji:"1f451"},
      {l:"R", sound:"r", word:"rainbow", emoji:"1f308"},
      {l:"S", sound:"s", word:"sun", emoji:"2600-fe0f"},
      {l:"T", sound:"t", word:"tiger", emoji:"1f405"},
      {l:"U", sound:"ŭ", word:"umbrella", emoji:"2602-fe0f"},
      {l:"V", sound:"v", word:"violin", emoji:"1f3bb"},
      {l:"W", sound:"w", word:"watermelon", emoji:"1f349"},
      {l:"X", sound:"ks", word:"box", emoji:"1f4e6"},
      {l:"Y", sound:"y", word:"yak", emoji:"1f402"},
      {l:"Z", sound:"z", word:"zebra", emoji:"1f993"}
    ];

    let i = 0;
    const letterEl = document.getElementById('letterDisplay');
    const wordEl = document.getElementById('word');
    const imgEl = document.getElementById('image');

    function showLetter() {
      const p = phonics[i];
      letterEl.textContent = p.l;
      wordEl.textContent = p.word;
      imgEl.src = `https://twemoji.maxcdn.com/v/latest/svg/${p.emoji}.svg`;
      letterEl.style.color = `hsl(${i * 360 / 26}, 90%, 60%)`;
      playSound('sparkleSound');
    }

    function speak(text, rate = 0.8, pitch = 1.4) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.rate = rate; utter.pitch = pitch;
      const voices = speechSynthesis.getVoices();
      utter.voice = voices.find(v => v.lang.startsWith('en')) || voices[0];
      speechSynthesis.cancel();
      speechSynthesis.speak(utter);
    }

    function addButton(id, action) {
      const btn = document.getElementById(id);
      if (btn) btn.onclick = () => { playSound('pop'); tapEffect(btn); action(); };
    }

    // Mobile buttons
    addButton('soundBtn', () => {
      const p = phonics[i];
      const phrase = p.l === "A" ? "ă as in apple … A … apple" :
                     p.l === "Z" ? "z … zed … zebra" :
                     `${p.sound} … ${p.l} … ${p.word}`;
      speak(phrase, 0.75, 1.3);
    });
    addButton('singBtn', () => speak(`A B C D E F G … H I J K L M N O P … Q R S … T U V … W X Y and Z! Yay, letter ${phonics[i].l} is for ${phonics[i].word}!`, 0.8, 1.3));
    addButton('nextBtn', () => { i = (i + 1) % phonics.length; showLetter(); });
    addButton('traceBtn', () => {
      document.getElementById('traceScreen').classList.remove('hidden');
      document.getElementById('main').classList.add('hidden');
      document.getElementById('mobileNav').classList.add('hidden');
      drawGuide();
    });

    // Desktop buttons → trigger mobile ones
    ['soundBtnDesktop', 'singBtnDesktop', 'traceBtnDesktop', 'nextBtnDesktop'].forEach(id => {
      const btn = document.getElementById(id);
      if (btn) btn.onclick = () => document.getElementById(id.replace('Desktop', ''))?.click();
    });

    // Tracing
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let drawing = false;

    function drawGuide() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.font = 'bold 380px Comic Neue';
      ctx.fillStyle = '#ff6bcb44';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText(phonics[i].l, canvas.width/2, canvas.height/2 + 20);
    }

    canvas.addEventListener('pointerdown', e => { drawing = true; ctx.beginPath(); ctx.moveTo(e.offsetX, e.offsetY); });
    canvas.addEventListener('pointermove', e => {
      if (drawing) {
        ctx.lineWidth = 18; ctx.lineCap = 'round'; ctx.strokeStyle = '#ff1493';
        ctx.lineTo(e.offsetX, e.offsetY); ctx.stroke();
      }
    });
    ['pointerup', 'pointerleave'].forEach(ev => canvas.addEventListener(ev, () => drawing = false));

    document.getElementById('clearBtn').onclick = () => { playSound('click'); drawGuide(); };
    document.getElementById('backBtn').onclick = () => {
      playSound('click');
      document.getElementById('traceScreen').classList.add('hidden');
      document.getElementById('main').classList.remove('hidden');
      document.getElementById('mobileNav').classList.remove('hidden');
    };

    // Start
    showLetter();
  </script>
</body>
</html>
