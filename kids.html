<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>AlphaPal • Phonics ABC!</title>

  <!-- PWA Manifest (same as before) -->
  <link rel="manifest" href="data:application/manifest+json,{
    \"name\":\"AlphaPal – Phonics ABC\",
    \"short_name\":\"AlphaPal\",
    \"description\":\"Sing, sound & write the alphabet!\",
    \"start_url\":\"/\",
    \"display\":\"standalone\",
    \"background_color\":\"#fff0f8\",
    \"theme_color\":\"#ff6bcb\",
    \"icons\":[
      {\"src\":\"https://api.dicebear.com/7.x/shapes/svg?seed=AlphaPal&backgroundColor=ff6bcb&size=192\",\"sizes\":\"192x192\",\"type\":\"image/svg+xml\"},
      {\"src\":\"https://api.dicebear.com/7.x/shapes/svg?seed=AlphaPal&backgroundColor=ff6bcb&size=512\",\"sizes\":\"512x512\",\"type\":\"image/svg+xml\"}
    ]
  }">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="apple-touch-icon" href="https://api.dicebear.com/7.x/shapes/svg?seed=AlphaPal&backgroundColor=ff6bcb&size=180">

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Comic+Neue:wght@700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

  <style>
    body { font-family: 'Comic Neue', cursive; background: linear-gradient(135deg, #fff0f8, #e0f9ff); margin:0; height:100dvh; overflow:hidden; }
    h1 { font-family: 'Fredoka One', cursive; }
    .big-btn { width: 100px; height: 100px; font-size: 44px; border-radius: 50%; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
    .big-btn:active { transform: scale(0.92); }
    #letterDisplay { font-size: 200px; text-shadow: 10px 10px 25px rgba(0,0,0,0.25); }
    .rainbow { background: linear-gradient(90deg, #ff6bcb,#ffaecb,#a0e7ff,#9fffcb,#ffd580,#ff9f9f); -webkit-background-clip: text; color: transparent; }
    .sparkle { animation: sparkle 2s infinite; }
    @keyframes sparkle { 0%,100% { transform: scale(1) rotate(0deg); } 50% { transform: scale(1.15) rotate(5deg); } }
  </style>
</head>
<body class="flex flex-col">

  <div class="text-center py-6 bg-gradient-to-b from-pink-200 to-transparent">
    <h1 class="text-6xl rainbow sparkle">AlphaPal</h1>
    <p class="text-3xl text-purple-700 mt-2">Phonics • Sing • Write</p>
  </div>

  <div id="main" class="flex-1 flex flex-col items-center justify-center gap-10 px-6">

    <!-- Big Letter -->
    <div id="letterDisplay" class="sparkle transition-all duration-500">A</div>

    <!-- Word + Picture -->
    <div class="text-center">
      <div id="word" class="text-7xl font-bold text-purple-800 mb-4">apple</div>
      <img id="image" src="" class="w-56 h-56 mx-auto animate-bounce">
    </div>

    <!-- Buttons -->
    <div class="flex flex-wrap justify-center gap-8">
      <button id="soundBtn" class="big-btn bg-gradient-to-br from-red-400 to-pink-500 text-white">
        Sound
      </button>
      <button id="singBtn" class="big-btn bg-gradient-to-br from-purple-400 to-indigo-600 text-white">
        Sing
      </button>
      <button id="traceBtn" class="big-btn bg-gradient-to-br from-green-400 to-teal-500 text-white">
        Write
      </button>
      <button id="nextBtn" class="big-btn bg-gradient-to-br from-yellow-400 to-orange-500 text-white">
        Next
      </button>
    </div>
  </div>

  <!-- Tracing Screen -->
  <div id="traceScreen" class="hidden fixed inset-0 bg-gradient-to-b from-sky-200 to-pink-200 flex flex-col items-center justify-center">
    <canvas id="canvas" width="380" height="500" class="border-8 border-white rounded-3xl shadow-2xl bg-white/95"></canvas>
    <div class="mt-10 flex gap-10">
      <button id="clearBtn" class="px-12 py-6 bg-red-500 text-white text-3xl rounded-full shadow-lg">Clear</button>
      <button id="backBtn" class="px-12 py-6 bg-purple-600 text-white text-3xl rounded-full shadow-lg">Back</button>
    </div>
  </div>

  <script>
    lucide.createIcons();

    const phonics = [
      {l:"A", sound:"ă", name:"ay", word:"apple",      icon:"apple"},
      {l:"B", sound:"b", name:"bee", word:"ball",       icon:"ball"},
      {l:"C", sound:"k", name:"see", word:"cat",        icon:"cat"},
      {l:"D", sound:"d", name:"dee", word:"dog",        icon:"dog"},
      {l:"E", sound:"ĕ", name:"ee",  word:"elephant",   icon:"elephant"},
      {l:"F", sound:"f", name:"eff", word:"fish",       icon:"fish"},
      {l:"G", sound:"g", name:"jee", word:"giraffe",    icon:"giraffe"},
      {l:"H", sound:"h", name:"aitch", word:"hat",      icon:"hat"},
      {l:"I", sound:"ĭ", name:"eye", word:"igloo",      icon:"house"},
      {l:"J", sound:"j", name:"jay", word:"jam",        icon:"cookie"},
      {l:"K", sound:"k", name:"kay", word:"kite",       icon:"kite"},
      {l:"L", sound:"l", name:"el",  word:"lion",       icon:"lion"},
      {l:"M", sound:"m", name:"em",  word:"monkey",     icon:"monkey"},
      {l:"N", sound:"n", name:"en",  word:"nest",       icon:"nest"},
      {l:"O", sound:"ŏ", name:"oh",  word:"octopus",    icon:"octopus"},
      {l:"P", sound:"p", name:"pee", word:"penguin",    icon:"penguin"},
      {l:"Q", sound:"kw",name:"kyu", word:"queen",      icon:"crown"},
      {l:"R", sound:"r", name:"ar",  word:"rainbow",    icon:"rainbow"},
      {l:"S", sound:"s", name:"ess", word:"sun",        icon:"sun"},
      {l:"T", sound:"t", name:"tee", word:"tiger",      icon:"tiger"},
      {l:"U", sound:"ŭ", name:"yoo", word:"umbrella",   icon:"umbrella"},
      {l:"V", sound:"v", name:"vee", word:"violin",     icon:"music"},
      {l:"W",sound:"w", name:"double-yoo", word:"watermelon", icon:"watermelon"},
      {l:"X", sound:"ks",name:"ex",  word:"box",        icon:"package"},
      {l:"Y", sound:"y", name:"why", word:"yak",        icon:"yak"},
      {l:"Z", sound:"z", name:"zed", word:"zebra",      icon:"zebra"}  // South African "zed"
    ];

    let i = 0;
    const letterEl = document.getElementById('letterDisplay');
    const wordEl   = document.getElementById('word');
    const imgEl    = document.getElementById('image');

    function showLetter() {
      const p = phonics[i];
      letterEl.textContent = p.l;
      wordEl.textContent   = p.word;
      imgEl.src = `https://api.dicebear.com/7.x/icons/svg?icon=${p.icon}&backgroundColor=ffe5f0`;
      letterEl.style.color = `hsl(${i * 360 / 26}, 90%, 60%)`;
    }

    // PHONICS SOUND BUTTON
    document.getElementById('soundBtn').onclick = () => {
      const p = phonics[i];
      let phrase = `${p.sound} ... ${p.l} ... ${p.word}`;
      if (p.l === "A") phrase = "ă as in apple … A … apple";
      if (p.l === "Z") phrase = "z … zed … zebra";
      
      speak(phrase, 0.75, 1.3);
    };

    // SING ABC BUTTON
    document.getElementById('singBtn').onclick = () => {
      const p = phonics[i];
      speak(`♪ A B C D E F G … H I J K L M N O P … Q R S … T U V … W X Y and Z! ♪ Yay, letter ${p.l} is for ${p.word}!`, 0.8, 1.3);
    };

    function speak(text, rate = 0.8, pitch = 1.4) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.rate = rate;
      utter.pitch = pitch;
      // Try to get a friendly female voice (works on most phones/tablets)
      const voices = speechSynthesis.getVoices();
      utter.voice = voices.find(v => v.name.includes('Karen') || v.name.includes('Google UK') || v.lang.startsWith('en')) || voices[0];
      speechSynthesis.cancel();
      speechSynthesis.speak(utter);
    }

    document.getElementById('nextBtn').onclick = () => {
      i = (i + 1) % phonics.length;
      showLetter();
    };

    // Tracing screen (same as before, just a bit bigger)
    const traceScreen = document.getElementById('traceScreen');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let drawing = false;

    function drawGuide() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.font = 'bold 360px Comic Neue';
      ctx.fillStyle = '#ff6bcb33';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText(phonics[i].l, canvas.width/2, canvas.height/2);
    }

    document.getElementById('traceBtn').onclick = () => {
      traceScreen.classList.remove('hidden');
      document.getElementById('main').classList.add('hidden');
      drawGuide();
    };

    canvas.addEventListener('pointerdown', e=>{ drawing=true; ctx.beginPath(); ctx.moveTo(e.offsetX, e.offsetY); });
    canvas.addEventListener('pointermove', e=>{
      if(drawing){
        ctx.lineWidth=14; ctx.lineCap='round'; ctx.strokeStyle='#ff6bcb';
        ctx.lineTo(e.offsetX, e.offsetY); ctx.stroke();
      }
    });
    canvas.addEventListener('pointerup', ()=>drawing=false);

    document.getElementById('clearBtn').onclick = drawGuide;
    document.getElementById('backBtn').onclick = () => {
      traceScreen.classList.add('hidden');
      document.getElementById('main').classList.remove('hidden');
    };

    // Start
    showLetter();
  </script>
</body>
</html>
