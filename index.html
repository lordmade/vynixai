<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover, user-scalable=no"/>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="format-detection" content="telephone=no">
 
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#4285F4">
  <meta name="description" content="AI-powered educational assistant for students">
 
  <title>Vynix</title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Symbols+Rounded" rel="stylesheet"/>
 
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
   
    html, body {
      height: 100%;
      width: 100%;
      overflow: hidden;
      background: #4285F4;
    }
   
    body {
      font-family: 'Outfit', system-ui, sans-serif;
      display: flex;
      flex-direction: column;
      position: relative;
    }
   
    /* X-Style Blue Splash Background */
    .splash-container {
      position: fixed;
      inset: 0;
      background: #4285F4;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1;
    }
   
    /* Animated Logo Container */
    .logo-wrapper {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 24px;
      animation: fadeInScale 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
   
    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: scale(0.8) translateY(20px);
      }
      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }
   
    /* X-Style Logo Mark */
    .brand-mark {
      width: 80px;
      height: 80px;
      background: white;
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
      position: relative;
      overflow: hidden;
    }
   
    .brand-mark::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(255,255,255,0.3) 0%, transparent 50%);
    }
   
    .brand-mark span {
      font-size: 40px;
      font-weight: 700;
      color: #4285F4;
      font-family: 'Outfit', sans-serif;
    }
   
    /* Brand Name */
    .brand-name {
      color: white;
      font-size: 2rem;
      font-weight: 600;
      letter-spacing: -0.5px;
      text-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
   
    .brand-tagline {
      color: rgba(255, 255, 255, 0.8);
      font-size: 1rem;
      font-weight: 400;
      margin-top: 8px;
    }
   
    /* Loading Indicator */
    .loading-ring {
      position: absolute;
      bottom: 120px;
      width: 40px;
      height: 40px;
      border: 3px solid rgba(255, 255, 255, 0.2);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
   
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
   
    /* Redirect Message */
    .redirect-text {
      position: absolute;
      bottom: 80px;
      color: rgba(255, 255, 255, 0.7);
      font-size: 0.875rem;
      font-weight: 500;
      opacity: 0;
      animation: fadeIn 0.5s ease 0.5s forwards;
    }
   
    @keyframes fadeIn {
      to { opacity: 1; }
    }
   
    /* PWA Install Banner - Kept as requested */
    .install-banner {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: linear-gradient(135deg, #4285F4 0%, #34A853 100%);
      color: white;
      padding: calc(12px + env(safe-area-inset-top, 0px)) 16px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      z-index: 10000;
      transform: translateY(-100%);
      transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
      box-shadow: 0 4px 20px rgba(66, 133, 244, 0.3);
    }
   
    .install-banner.visible {
      transform: translateY(0);
    }
   
    .install-banner-content {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
    }
   
    .install-icon {
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: #4285F4;
      font-size: 1.2rem;
      flex-shrink: 0;
    }
   
    .install-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
   
    .install-title {
      font-weight: 600;
      font-size: 0.95rem;
      line-height: 1.2;
    }
   
    .install-subtitle {
      font-size: 0.8rem;
      opacity: 0.9;
    }
   
    .install-actions {
      display: flex;
      gap: 8px;
      align-items: center;
    }
   
    .install-btn {
      background: white;
      color: #4285F4;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }
   
    .install-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
   
    .install-close {
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }
   
    .install-close:hover {
      background: rgba(255,255,255,0.3);
    }
   
    /* Adjust splash when banner visible */
    body.banner-visible .splash-container {
      margin-top: 70px;
      height: calc(100% - 70px);
    }
   
    body.banner-visible .loading-ring,
    body.banner-visible .redirect-text {
      bottom: calc(80px + 70px);
    }
   
    body.banner-visible .redirect-text {
      bottom: calc(40px + 70px);
    }
   
    /* Responsive */
    @media (max-width: 480px) {
      .brand-mark {
        width: 70px;
        height: 70px;
        border-radius: 18px;
      }
      .brand-mark span {
        font-size: 34px;
      }
      .brand-name {
        font-size: 1.75rem;
      }
      .brand-tagline {
        font-size: 0.9rem;
      }
    }
   
    /* Exit animation */
    .splash-exit {
      animation: splashOut 0.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
   
    @keyframes splashOut {
      to {
        opacity: 0;
        transform: scale(1.1);
      }
    }
  </style>
</head>
<body>
  <!-- PWA Install Banner -->
  <div class="install-banner" id="installBanner">
    <div class="install-banner-content">
      <div class="install-icon">V</div>
      <div class="install-text">
        <div class="install-title">Install Vynix AI</div>
        <div class="install-subtitle">Add to home screen for easy access</div>
      </div>
    </div>
    <div class="install-actions">
      <button class="install-btn" id="installBtn" onclick="installPWA()">Install</button>
      <button class="install-close" onclick="dismissInstallBanner()" title="Dismiss">
        <span class="material-symbols-rounded" style="font-size:18px">close</span>
      </button>
    </div>
  </div>
 
  <!-- X-Style Splash Screen -->
  <div class="splash-container" id="splashContainer">
    <div class="logo-wrapper">
      <div class="brand-mark">
        <span>V</span>
      </div>
      <div style="text-align: center;">
        <div class="brand-name">Vynix Chat</div>
        <div class="brand-tagline">Education</div>
      </div>
    </div>
   
    <div class="loading-ring"></div>
    <div class="redirect-text" id="redirectText">Opening app...</div>
  </div>
 
  <script>
    // ==================== PWA INSTALLATION (Kept as requested) ====================
    let deferredPrompt = null;
    let installBannerDismissed = false;
   
    // Register Service Worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('SW registered:', registration.scope);
          })
          .catch(err => {
            console.log('SW registration failed:', err);
          });
      });
    }
   
    // Check if app is already installed
    function isAppInstalled() {
      const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
      const isIOSStandalone = window.navigator.standalone === true;
      return isStandalone || isIOSStandalone;
    }
   
    // Check if iOS
    function isIOS() {
      return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
    }
   
    // Handle Chrome/Edge install prompt
    window.addEventListener('beforeinstallprompt', (e) => {
      console.log('beforeinstallprompt fired');
      e.preventDefault();
      deferredPrompt = e;
     
      setTimeout(() => {
        if (!installBannerDismissed && !isAppInstalled()) {
          showInstallBanner();
        }
      }, 2000);
    });
   
    // Handle successful install
    window.addEventListener('appinstalled', () => {
      console.log('PWA was installed');
      deferredPrompt = null;
      hideInstallBanner();
      localStorage.setItem('vynix_installed', 'true');
    });
   
    function showInstallBanner() {
      const banner = document.getElementById('installBanner');
      if (!banner) return;
     
      if (isAppInstalled()) return;
     
      banner.classList.add('visible');
      document.body.classList.add('banner-visible');
    }
   
    function hideInstallBanner() {
      const banner = document.getElementById('installBanner');
      if (banner) banner.classList.remove('visible');
      document.body.classList.remove('banner-visible');
    }
   
    function dismissInstallBanner() {
      installBannerDismissed = true;
      hideInstallBanner();
      localStorage.setItem('vynix_install_banner_dismissed', Date.now().toString());
    }
   
    async function installPWA() {
      if (isIOS()) {
        showIOSInstructions();
        return;
      }
     
      if (!deferredPrompt) {
        showManualInstallInstructions();
        return;
      }
     
      deferredPrompt.prompt();
     
      try {
        const { outcome } = await deferredPrompt.userChoice;
        console.log('Install prompt result:', outcome);
       
        if (outcome === 'accepted') {
          deferredPrompt = null;
          hideInstallBanner();
        }
      } catch (err) {
        console.error('Install error:', err);
      }
    }
   
    function showIOSInstructions() {
      const div = document.createElement('div');
      div.className = 'ios-instructions';
      div.innerHTML = `
        <div style="
          position:fixed;
          top:50%;
          left:50%;
          transform:translate(-50%,-50%);
          background:white;
          padding:24px;
          border-radius:16px;
          box-shadow:0 20px 60px rgba(0,0,0,0.3);
          z-index:20000;
          max-width:320px;
          text-align:center;
        ">
          <h3 style="margin-bottom:16px;">Install Vynix AI</h3>
          <p style="color:#666; margin-bottom:16px;">
            Tap <span style="font-weight:bold;">Share</span> button below, then tap
            <span style="font-weight:bold;">"Add to Home Screen"</span>
          </p>
          <div style="font-size:40px; margin:16px 0;">ðŸ“²</div>
          <button onclick="this.closest('.ios-instructions').remove()"
            style="
              background:#4285F4;
              color:white;
              border:none;
              padding:12px 24px;
              border-radius:24px;
              font-weight:600;
              cursor:pointer;
              margin-top:8px;
            ">Got it</button>
        </div>
        <div style="
          position:fixed;
          inset:0;
          background:rgba(0,0,0,0.5);
          z-index:19999;
        " onclick="this.parentElement.remove()"></div>
      `;
      document.body.appendChild(div);
    }
   
    function showManualInstallInstructions() {
      const isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
      const message = isChrome
        ? 'To install: Tap the menu (â‹®) in the top right, then "Install app" or "Add to home screen"'
        : 'To install this app, use your browser menu and select "Add to home screen"';
     
      alert(message);
    }
   
    // Check stored states on load
    (function initInstallBanner() {
      const dismissed = localStorage.getItem('vynix_install_banner_dismissed');
      const installed = localStorage.getItem('vynix_installed');
     
      if (installed) {
        installBannerDismissed = true;
      }
     
      if (dismissed) {
        const dismissedTime = parseInt(dismissed);
        const daysSince = (Date.now() - dismissedTime) / (1000 * 60 * 60 * 24);
        if (daysSince < 7) {
          installBannerDismissed = true;
        }
      }
     
      // Show banner for iOS if not installed/dismissed
      if (isIOS() && !installBannerDismissed && !isAppInstalled()) {
        setTimeout(() => {
          showInstallBanner();
        }, 3000);
      }
    })();
   
    // ==================== AUTO REDIRECT LOGIC ====================
    (function initSplashRedirect() {
      const REDIRECT_URL = '/home.html'; // Change this to your home page
      const SPLASH_DURATION = 3000; // 3 seconds
     
      // If already installed, show exit animation and redirect
      if (isAppInstalled()) {
        document.getElementById('redirectText').textContent = 'Opening app...';
       
        setTimeout(() => {
          const splash = document.getElementById('splashContainer');
          splash.classList.add('splash-exit');
         
          // Redirect after exit animation
          setTimeout(() => {
            window.location.href = REDIRECT_URL;
          }, 500);
        }, SPLASH_DURATION);
      } else {
        // Not installed - show install prompt after delay, stay on splash
        document.getElementById('redirectText').textContent = 'Tap Install to get started';
       
        // Optional: Auto-redirect to install page or stay for install
        // Uncomment below to redirect to marketing page instead:
        /*
        setTimeout(() => {
          window.location.href = '/install.html';
        }, 5000);
        */
      }
    })();
  </script>
</body>
</html>
