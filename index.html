<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover, user-scalable=no"/>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="format-detection" content="telephone=no">
 
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#000000">
  <meta name="description" content="AI-powered educational assistant for students">
 
  <title>Vynix Chat</title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Symbols+Rounded" rel="stylesheet"/>
 
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
   
    html, body {
      height: 100%;
      width: 100%;
      overflow: hidden;
      background: #ffffff;
    }
   
    body {
      font-family: 'Outfit', system-ui, -apple-system, sans-serif;
      display: flex;
      flex-direction: column;
      position: relative;
    }
   
    /* X-Style White Splash Background */
    .splash-container {
      position: fixed;
      inset: 0;
      background: #ffffff;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1;
    }
   
    /* Centered Logo - X Style but White BG */
    .logo-wrapper {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: fadeInScale 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
   
    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: scale(0.9);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }
   
    /* The V Logo - Geometric X Style */
    .v-logo {
      width: 72px;
      height: 72px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }
   
    .v-logo svg {
      width: 100%;
      height: 100%;
      fill: #000000;
      filter: drop-shadow(0 4px 20px rgba(0,0,0,0.1));
    }
   
    /* App Name - X Style Typography */
    .app-name {
      margin-top: 24px;
      color: #000000;
      font-size: 1.75rem;
      font-weight: 700;
      letter-spacing: -0.5px;
      opacity: 0;
      animation: fadeIn 0.4s ease 0.3s forwards;
    }
   
    @keyframes fadeIn {
      to { opacity: 1; }
    }
   
    /* Loading Bar - X Style */
    .loading-container {
      position: absolute;
      bottom: 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
    }
   
    .progress-bar {
      width: 120px;
      height: 3px;
      background: #e5e5e5;
      border-radius: 3px;
      overflow: hidden;
      position: relative;
    }
   
    .progress-fill {
      height: 100%;
      background: #000000;
      width: 0%;
      animation: loadProgress 3s ease-out forwards;
    }
   
    @keyframes loadProgress {
      0% { width: 0%; }
      100% { width: 100%; }
    }
   
    .loading-text {
      color: #666666;
      font-size: 0.875rem;
      font-weight: 500;
      opacity: 0;
      animation: fadeIn 0.4s ease 0.5s forwards;
    }
   
    /* Exit Animation */
    .splash-exit {
      animation: splashOut 0.4s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
   
    @keyframes splashOut {
      to {
        opacity: 0;
        transform: scale(1.05);
      }
    }
   
    /* BLACK PWA Install Banner - X Style */
    .install-banner {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: #000000;
      color: #ffffff;
      padding: calc(12px + env(safe-area-inset-top, 0px)) 16px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      z-index: 10000;
      transform: translateY(-100%);
      transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }
   
    .install-banner.visible {
      transform: translateY(0);
    }
   
    .install-banner-content {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
    }
   
    .install-icon {
      width: 40px;
      height: 40px;
      background: #ffffff;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
   
    .install-icon svg {
      width: 24px;
      height: 24px;
      fill: #000000;
    }
   
    .install-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
   
    .install-title {
      font-weight: 700;
      font-size: 0.95rem;
      line-height: 1.2;
      color: #ffffff;
    }
   
    .install-subtitle {
      font-size: 0.8rem;
      color: #a0a0a0;
      font-weight: 400;
    }
   
    .install-actions {
      display: flex;
      gap: 8px;
      align-items: center;
    }
   
    .install-btn {
      background: #ffffff;
      color: #000000;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      font-weight: 700;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }
   
    .install-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(255,255,255,0.2);
    }
   
    .install-close {
      background: rgba(255,255,255,0.15);
      border: none;
      color: #ffffff;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }
   
    .install-close:hover {
      background: rgba(255,255,255,0.25);
    }
   
    /* Adjust splash when banner visible */
    body.banner-visible .splash-container {
      margin-top: 70px;
      height: calc(100% - 70px);
    }
   
    body.banner-visible .loading-container {
      bottom: calc(80px + 70px);
    }
   
    /* iOS Install Modal - Black Theme */
    .ios-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(10px);
      z-index: 19999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }
   
    .ios-modal-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }
   
    .ios-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.9);
      background: #000000;
      padding: 32px;
      border-radius: 20px;
      width: 90%;
      max-width: 340px;
      text-align: center;
      z-index: 20000;
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s cubic-bezier(0.22, 1, 0.36, 1);
      border: 1px solid #333;
    }
   
    .ios-modal.active {
      opacity: 1;
      pointer-events: auto;
      transform: translate(-50%, -50%) scale(1);
    }
   
    .ios-modal h3 {
      color: #ffffff;
      margin-bottom: 16px;
      font-size: 1.25rem;
      font-weight: 700;
    }
   
    .ios-modal p {
      color: #a0a0a0;
      margin-bottom: 24px;
      line-height: 1.5;
      font-size: 0.95rem;
    }
   
    .ios-modal .share-icon {
      font-size: 48px;
      margin: 16px 0;
      color: #4285F4;
    }
   
    .ios-modal button {
      background: #ffffff;
      color: #000000;
      border: none;
      padding: 14px 32px;
      border-radius: 24px;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      width: 100%;
      transition: transform 0.2s;
    }
   
    .ios-modal button:hover {
      transform: scale(1.02);
    }
   
    /* Responsive */
    @media (max-width: 480px) {
      .v-logo {
        width: 64px;
        height: 64px;
      }
      .app-name {
        font-size: 1.5rem;
      }
      .install-banner {
        padding: calc(10px + env(safe-area-inset-top, 0px)) 12px 10px;
      }
      .install-icon {
        width: 36px;
        height: 36px;
      }
      .install-icon svg {
        width: 20px;
        height: 20px;
      }
      .install-title {
        font-size: 0.9rem;
      }
      .install-subtitle {
        font-size: 0.75rem;
      }
      .install-btn {
        padding: 8px 16px;
        font-size: 0.85rem;
      }
    }
  </style>
</head>
<body>
  <!-- BLACK PWA Install Banner -->
  <div class="install-banner" id="installBanner">
    <div class="install-banner-content">
      <div class="install-icon">
        <!-- V Icon for Banner -->
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 21.5L2.25 2.25h3.5l6.25 12.5 6.25-12.5h3.5L12 21.5z"/>
        </svg>
      </div>
      <div class="install-text">
        <div class="install-title">Install Vynix Chat</div>
        <div class="install-subtitle">Add to home screen for easy access</div>
      </div>
    </div>
    <div class="install-actions">
      <button class="install-btn" id="installBtn" onclick="installPWA()">Install</button>
      <button class="install-close" onclick="dismissInstallBanner()" title="Dismiss">
        <span class="material-symbols-rounded" style="font-size:18px">close</span>
      </button>
    </div>
  </div>
 
  <!-- X-Style White Splash Screen -->
  <div class="splash-container" id="splashContainer">
    <div class="logo-wrapper">
      <!-- V Logo SVG - Geometric X Style -->
      <div class="v-logo">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <!-- Geometric V matching X style - angular, sharp, same visual weight -->
          <path d="M12 21.5L2.25 2.25h3.5l6.25 12.5 6.25-12.5h3.5L12 21.5z"/>
        </svg>
      </div>
      <div class="app-name">Vynix Chat</div>
    </div>
   
    <div class="loading-container">
      <div class="progress-bar">
        <div class="progress-fill"></div>
      </div>
      <div class="loading-text" id="loadingText">Loading...</div>
    </div>
  </div>
 
  <!-- iOS Install Modal -->
  <div class="ios-modal-overlay" id="iosModalOverlay" onclick="closeIOSModal()"></div>
  <div class="ios-modal" id="iosModal">
    <h3>Install Vynix Chat</h3>
    <div class="share-icon">ðŸ“²</div>
    <p>Tap the <strong>Share</strong> button below, then select <strong>"Add to Home Screen"</strong></p>
    <button onclick="closeIOSModal()">Got it</button>
  </div>
 
  <script>
    // ==================== PWA INSTALLATION ====================
    let deferredPrompt = null;
    let installBannerDismissed = false;
   
    // Register Service Worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('SW registered:', registration.scope);
          })
          .catch(err => {
            console.log('SW registration failed:', err);
          });
      });
    }
   
    // Check if app is already installed
    function isAppInstalled() {
      const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
      const isIOSStandalone = window.navigator.standalone === true;
      return isStandalone || isIOSStandalone;
    }
   
    // Check if iOS
    function isIOS() {
      return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
    }
   
    // Handle Chrome/Edge install prompt
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
     
      setTimeout(() => {
        if (!installBannerDismissed && !isAppInstalled()) {
          showInstallBanner();
        }
      }, 1500);
    });
   
    // Handle successful install
    window.addEventListener('appinstalled', () => {
      deferredPrompt = null;
      hideInstallBanner();
      localStorage.setItem('vynix_installed', 'true');
    });
   
    function showInstallBanner() {
      const banner = document.getElementById('installBanner');
      if (!banner || isAppInstalled()) return;
     
      banner.classList.add('visible');
      document.body.classList.add('banner-visible');
    }
   
    function hideInstallBanner() {
      const banner = document.getElementById('installBanner');
      if (banner) banner.classList.remove('visible');
      document.body.classList.remove('banner-visible');
    }
   
    function dismissInstallBanner() {
      installBannerDismissed = true;
      hideInstallBanner();
      localStorage.setItem('vynix_install_banner_dismissed', Date.now().toString());
    }
   
    async function installPWA() {
      if (isIOS()) {
        showIOSModal();
        return;
      }
     
      if (!deferredPrompt) {
        showManualInstallInstructions();
        return;
      }
     
      deferredPrompt.prompt();
     
      try {
        const { outcome } = await deferredPrompt.userChoice;
        if (outcome === 'accepted') {
          deferredPrompt = null;
          hideInstallBanner();
        }
      } catch (err) {
        console.error('Install error:', err);
      }
    }
   
    function showIOSModal() {
      document.getElementById('iosModalOverlay').classList.add('active');
      document.getElementById('iosModal').classList.add('active');
    }
   
    function closeIOSModal() {
      document.getElementById('iosModalOverlay').classList.remove('active');
      document.getElementById('iosModal').classList.add('active');
    }
   
    function showManualInstallInstructions() {
      const isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
      const message = isChrome
        ? 'To install: Tap the menu (â‹®) in the top right, then "Install app" or "Add to home screen"'
        : 'To install this app, use your browser menu and select "Add to home screen"';
      alert(message);
    }
   
    // Initialize banner state
    (function initInstallBanner() {
      const dismissed = localStorage.getItem('vynix_install_banner_dismissed');
      const installed = localStorage.getItem('vynix_installed');
     
      if (installed) installBannerDismissed = true;
     
      if (dismissed) {
        const dismissedTime = parseInt(dismissed);
        const daysSince = (Date.now() - dismissedTime) / (1000 * 60 * 60 * 24);
        if (daysSince < 7) installBannerDismissed = true;
      }
     
      if (isIOS() && !installBannerDismissed && !isAppInstalled()) {
        setTimeout(() => showInstallBanner(), 2500);
      }
    })();
   
    // ==================== AUTO REDIRECT ====================
    (function initSplash() {
      const REDIRECT_URL = '/home.html'; // Change to your main app URL
      const SPLASH_DURATION = 3000; // 3 seconds
      
      // Update loading text based on install state
      const loadingText = document.getElementById('loadingText');
      
      if (isAppInstalled()) {
        loadingText.textContent = 'Opening Vynix Chat...';
        
        setTimeout(() => {
          document.getElementById('splashContainer').classList.add('splash-exit');
          setTimeout(() => {
            window.location.href = REDIRECT_URL;
          }, 400);
        }, SPLASH_DURATION);
      } else {
        loadingText.textContent = 'Tap Install to get started';
        // Show install banner after a moment if not dismissed
        setTimeout(() => {
          if (!installBannerDismissed) showInstallBanner();
        }, 2000);
      }
    })();
  </script>
</body>
</html>
