<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vynix Max • Welcome</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Symbols+Rounded" rel="stylesheet"/>
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  
  <style>
    :root {
      --bg: #000;
      --surface: #141414;
      --accent: #e50914;
      --accent-hover: #f40613;
      --text: #ffffff;
      --text-dim: #b3b3b3;
      --border: rgba(255,255,255,0.14);
      --google-blue: #4285F4;
      --error: #ff4d4d;
      --success: #00c853;
      --warning: #ff9800;
      --transition: all 0.28s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Inter', system-ui, sans-serif;
      min-height: 100vh;
    }

    .hero {
      position: relative;
      height: 100vh;
      min-height: 780px;
      background:
        linear-gradient(to bottom, rgba(0,0,0,0.2) 0%, rgba(20,0,40,0.65) 45%, #000 92%),
        url('https://images.unsplash.com/photo-1557683316-973673baf926?auto=format&fit=crop&w=2400&q=90') center 38% / cover no-repeat fixed;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 2.8rem 5% 5rem;
    }

    .hero-content { max-width: 860px; }
    .hero-logo {
      font-size: clamp(4.2rem, 11vw, 8.6rem);
      font-weight: 900;
      letter-spacing: -5px;
      background: linear-gradient(90deg, #fff 0%, #fff 45%, var(--accent) 58%, #ff4d4d 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .hero-subtitle {
      font-size: clamp(1.4rem, 4.2vw, 2.1rem);
      font-weight: 500;
      color: rgba(255,255,255,0.92);
      max-width: 780px;
    }

    .pricing-badge {
      position: absolute;
      top: 1.6rem;
      right: 1.6rem;
      width: 148px;
      height: 148px;
      background: rgba(0,0,0,0.78);
      border: 3.5px solid var(--accent);
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      box-shadow: 0 12px 40px rgba(229,9,20,0.45);
      backdrop-filter: blur(10px);
    }

    .pricing-price { font-size: 3rem; font-weight: 900; }
    .pricing-text   { font-size: 1rem; opacity: 0.92; margin-top: 6px; }

    .auth-container {
      width: 100%;
      max-width: 500px;
      margin: 0 auto;
      background: rgba(20,20,20,0.96);
      backdrop-filter: blur(16px);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 3.4rem 3rem;
      box-shadow: 0 30px 90px rgba(0,0,0,0.82);
    }

    h1 { font-size: 2.3rem; font-weight: 800; margin-bottom: 0.7rem; text-align: center; }
    .subtitle { color: var(--text-dim); text-align: center; margin-bottom: 2.4rem; font-size: 1.08rem; }

    .form-group { margin-bottom: 1.9rem; position: relative; }

    label { display: block; margin-bottom: 0.6rem; font-weight: 500; font-size: 0.98rem; color: var(--text-dim); }

    input {
      width: 100%;
      padding: 1.15rem 1.4rem;
      background: rgba(255,255,255,0.06);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: white;
      font-size: 1.1rem;
    }

    input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 4px rgba(229,9,20,0.25);
    }

    .password-wrapper { position: relative; }

    .toggle-password {
      position: absolute;
      right: 1.2rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: var(--text-dim);
      cursor: pointer;
      font-size: 1.5rem;
    }

    .btn {
      width: 100%;
      padding: 1.25rem;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1.16rem;
      font-weight: 700;
      cursor: pointer;
      margin: 1.8rem 0 1.2rem;
      position: relative;
    }

    .btn:hover:not(:disabled) { background: var(--accent-hover); transform: translateY(-2px); }

    .btn:disabled { background: #444; cursor: not-allowed; }

    .link {
      color: var(--accent);
      text-decoration: none;
      cursor: pointer;
    }

    .link:hover { text-decoration: underline; }

    /* Forgot Password Modal */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.75);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      backdrop-filter: blur(4px);
    }

    .modal-content {
      background: var(--surface);
      border-radius: 16px;
      padding: 2.5rem;
      width: 90%;
      max-width: 420px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.6);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .close-btn {
      background: none;
      border: none;
      color: var(--text-dim);
      font-size: 1.8rem;
      cursor: pointer;
    }

    .info-text {
      font-size: 0.95rem;
      color: var(--text-dim);
      margin-bottom: 1.8rem;
      line-height: 1.45;
    }

    .toast-container {
      position: fixed;
      top: 24px;
      right: 24px;
      z-index: 10000;
    }

    .toast {
      min-width: 340px;
      background: #1e1e1e;
      border-radius: 12px;
      padding: 16px 20px;
      display: flex;
      align-items: center;
      gap: 14px;
      box-shadow: 0 12px 40px rgba(0,0,0,0.7);
      transform: translateX(120%);
      opacity: 0;
      transition: all 0.45s ease-out;
    }

    .toast.show { transform: translateX(0); opacity: 1; }

    .toast.success { border-left: 5px solid var(--success); }
    .toast.error   { border-left: 5px solid var(--error); }
    .toast.warning { border-left: 5px solid var(--warning); }

    .hidden { display: none !important; }

    @media (max-width: 768px) {
      .hero { padding: 2rem 6%; min-height: 680px; background-attachment: scroll; }
      .pricing-badge { width: 124px; height: 124px; }
      .auth-container { padding: 2.8rem 2.4rem; }
      .modal-content { padding: 2rem; }
    }
  </style>
</head>
<body>

<section class="hero">
  <div class="hero-content">
    <h1 class="hero-logo">VYNIX MAX</h1>
    <p class="hero-subtitle">Limitless movies, series, anime & originals. Stream anywhere.</p>
  </div>

  <div class="pricing-badge">
    <div class="pricing-price">R39</div>
    <div class="pricing-text">/ month</div>
  </div>

  <div class="auth-container">
    <!-- SIGN IN -->
    <div id="signinView">
      <h1>Sign In</h1>
      <p class="subtitle">Continue to Vynix Max</p>

      <div id="verificationNotice" class="info-box hidden" style="background:rgba(255,152,0,0.15); border-left:4px solid var(--warning); padding:1.2rem; border-radius:8px; margin:1.5rem 0;">
        <strong>Please verify your email first.</strong><br>
        We sent a verification link to your email address.<br>
        Check your inbox (and spam/junk folder).
      </div>

      <form id="signinForm">
        <div class="form-group">
          <label for="signinEmail">Email</label>
          <input type="email" id="signinEmail" placeholder="name@example.com" autocomplete="email" required autofocus/>
        </div>

        <div class="form-group">
          <label for="signinPassword">Password</label>
          <div class="password-wrapper">
            <input type="password" id="signinPassword" placeholder="••••••••" autocomplete="current-password" required/>
            <button type="button" class="toggle-password material-symbols-rounded" data-target="signinPassword">visibility</button>
          </div>
        </div>

        <div style="text-align:right; margin-bottom:1.5rem;">
          <a class="link" id="forgotPasswordLink">Forgot password?</a>
        </div>

        <button type="submit" class="btn" id="signInBtn">
          <span>Sign In</span>
        </button>
      </form>

      <button id="resendVerificationBtn" class="btn" style="background:transparent; border:1px solid var(--accent); color:var(--accent);" class="hidden">
        Resend Verification Email
      </button>

      <div style="text-align:center; margin:1.8rem 0; color:#777;">OR</div>

      <button type="button" class="btn" id="googleSignInBtn" style="background:white; color:#000; display:flex; align-items:center; justify-content:center; gap:12px;">
        <svg width="24" height="24" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.51h5.84c-.25 1.31-.98 2.42-2.07 3.16v2.63h3.35c1.96-1.81 3.09-4.47 3.09-7.99z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-1.01 7.28-2.73l-3.35-2.63c-1.01.68-2.29 1.08-3.93 1.08-3.02 0-5.58-2.04-6.49-4.79H.96v2.67C2.77 20.39 7.01 23 12 23z"/><path fill="#FBBC05" d="M5.51 14.21c-.23-.68-.36-1.41-.36-2.21s.13-1.53.36-2.21V7.34H.96C.35 8.85 0 10.39 0 12s.35 3.15.96 4.66l4.55-2.45z"/><path fill="#EA4335" d="M12 4.98c1.64 0 3.11.56 4.27 1.66l3.19-3.19C17.46 1.01 14.97 0 12 0 7.01 0 2.77 2.61 0.96 6.34l4.55 2.45C6.42 6.02 8.98 4.98 12 4.98z"/></svg>
        Continue with Google
      </button>

      <div style="text-align:center; margin-top:1.8rem;">
        New to Vynix Max? <a href="#" id="switchToSignup" style="color:var(--accent);">Sign up now</a>
      </div>
    </div>

    <!-- SIGN UP -->
    <div id="signupView" class="hidden">
      <h1>Create Account</h1>
      <p class="subtitle">Join Vynix Max today</p>

      <form id="signupForm">
        <div class="form-group">
          <label for="signupName">Full Name</label>
          <input type="text" id="signupName" placeholder="Your name" autocomplete="name" required/>
        </div>

        <div class="form-group">
          <label for="signupEmail">Email</label>
          <input type="email" id="signupEmail" placeholder="name@example.com" autocomplete="email" required/>
        </div>

        <div class="form-group">
          <label for="signupPassword">Password</label>
          <div class="password-wrapper">
            <input type="password" id="signupPassword" placeholder="At least 6 characters" autocomplete="new-password" required minlength="6"/>
            <button type="button" class="toggle-password material-symbols-rounded" data-target="signupPassword">visibility</button>
          </div>
        </div>

        <button type="submit" class="btn" id="signUpBtn">
          <span>Create Account</span>
        </button>
      </form>

      <div style="text-align:center; margin:1.8rem 0; color:#777;">OR</div>

      <button type="button" class="btn" id="googleSignupBtn" style="background:white; color:#000; display:flex; align-items:center; justify-content:center; gap:12px;">
        <svg width="24" height="24" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.51h5.84c-.25 1.31-.98 2.42-2.07 3.16v2.63h3.35c1.96-1.81 3.09-4.47 3.09-7.99z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-1.01 7.28-2.73l-3.35-2.63c-1.01.68-2.29 1.08-3.93 1.08-3.02 0-5.58-2.04-6.49-4.79H.96v2.67C2.77 20.39 7.01 23 12 23z"/><path fill="#FBBC05" d="M5.51 14.21c-.23-.68-.36-1.41-.36-2.21s.13-1.53.36-2.21V7.34H.96C.35 8.85 0 10.39 0 12s.35 3.15.96 4.66l4.55-2.45z"/><path fill="#EA4335" d="M12 4.98c1.64 0 3.11.56 4.27 1.66l3.19-3.19C17.46 1.01 14.97 0 12 0 7.01 0 2.77 2.61 0.96 6.34l4.55 2.45C6.42 6.02 8.98 4.98 12 4.98z"/></svg>
        Sign up with Google
      </button>

      <div style="text-align:center; margin-top:1.8rem;">
        Already have an account? <a href="#" id="switchToSignin" style="color:var(--accent);">Sign in</a>
      </div>
    </div>
  </div>
</section>

<!-- Forgot Password Modal -->
<div id="forgotModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Reset Password</h2>
      <button class="close-btn" id="closeModal">&times;</button>
    </div>
    <p class="info-text">Enter your email address and we'll send you a link to reset your password.</p>
    
    <form id="resetForm">
      <div class="form-group">
        <label for="resetEmail">Email</label>
        <input type="email" id="resetEmail" placeholder="name@example.com" autocomplete="email" required autofocus/>
      </div>
      <button type="submit" class="btn" id="sendResetBtn">
        <span>Send Reset Link</span>
      </button>
    </form>
  </div>
</div>

<div class="toast-container" id="toastContainer"></div>

<script>
// ==================== CONFIG ====================
const firebaseConfig = {
  apiKey: "AIzaSyBOyZ3As4GTuNvjemvPF_SpsC6m6vqtNhc",
  authDomain: "fire-b-a8878.firebaseapp.com",
  databaseURL: "https://fire-b-a8878.firebaseio.com",
  projectId: "fire-b-a8878",
  appId: "1:658673187627:web:6e4c29af661785f0afa36e"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

// ==================== HELPERS ====================
function $(id) { return document.getElementById(id); }

function showToast(message, type = 'info') {
  const toast = document.createElement('div');
  toast.className = `toast ${type}`;
  toast.innerHTML = `<span>${message}</span>`;
  $('toastContainer').appendChild(toast);
  
  setTimeout(() => toast.classList.add('show'), 100);
  setTimeout(() => {
    toast.classList.remove('show');
    setTimeout(() => toast.remove(), 500);
  }, 5200);
}

function setLoading(btn, isLoading) {
  btn.disabled = isLoading;
  btn.style.opacity = isLoading ? '0.7' : '1';
  btn.querySelector('span').textContent = isLoading ? 'Sending...' : 'Send Reset Link';
}

// ==================== DOM Elements ====================
const signinView     = $('signinView');
const signupView     = $('signupView');
const signinForm     = $('signinForm');
const signupForm     = $('signupForm');
const signInBtn      = $('signInBtn');
const signUpBtn      = $('signUpBtn');
const googleSignIn   = $('googleSignInBtn');
const googleSignup   = $('googleSignupBtn');
const switchToSignup = $('switchToSignup');
const switchToSignin = $('switchToSignin');
const resendBtn      = $('resendVerificationBtn');
const verificationNotice = $('verificationNotice');
const forgotModal    = $('forgotModal');
const closeModal     = $('closeModal');
const resetForm      = $('resetForm');
const sendResetBtn   = $('sendResetBtn');
const resetEmail     = $('resetEmail');
const forgotLink     = $('forgotPasswordLink');

// ==================== UI TOGGLES ====================
function showSignIn() { signinView.classList.remove('hidden'); signupView.classList.add('hidden'); }
function showSignUp() { signupView.classList.remove('hidden'); signinView.classList.add('hidden'); }

switchToSignup.onclick = e => { e.preventDefault(); showSignUp(); };
switchToSignin.onclick = e => { e.preventDefault(); showSignIn(); };

// Modal controls
forgotLink.onclick = () => { forgotModal.style.display = 'flex'; resetEmail.focus(); };
closeModal.onclick = () => forgotModal.style.display = 'none';
forgotModal.onclick = e => { if (e.target === forgotModal) forgotModal.style.display = 'none'; };

// Password visibility
document.querySelectorAll('.toggle-password').forEach(btn => {
  btn.onclick = () => {
    const input = $(btn.dataset.target);
    input.type = input.type === 'password' ? 'text' : 'password';
    btn.textContent = input.type === 'password' ? 'visibility' : 'visibility_off';
  };
});

// ==================== PASSWORD RESET ====================
resetForm.onsubmit = async (e) => {
  e.preventDefault();
  const email = resetEmail.value.trim();

  if (!email) {
    showToast("Please enter your email", 'error');
    return;
  }

  setLoading(sendResetBtn, true);

  try {
    await auth.sendPasswordResetEmail(email);
    showToast("Password reset link sent! Check your email (including spam).", 'success');
    forgotModal.style.display = 'none';
    resetEmail.value = '';
  } catch (err) {
    let msg = "Failed to send reset email";
    switch(err.code) {
      case 'auth/invalid-email':      msg = "Invalid email format"; break;
      case 'auth/user-not-found':     msg = "No account found with this email"; break;
      case 'auth/too-many-requests':  msg = "Too many requests. Try again later"; break;
      default:                        msg = err.message;
    }
    showToast(msg, 'error');
  } finally {
    setLoading(sendResetBtn, false);
  }
};

// ==================== EMAIL VERIFICATION & OTHER AUTH LOGIC ====================
async function sendVerificationEmail(user) {
  try {
    if (!user.emailVerified) {
      await user.sendEmailVerification();
      showToast("Verification email sent! Check your inbox.", 'success');
    }
  } catch (err) {
    showToast("Failed to send verification email.", 'error');
  }
}

function showUnverifiedState() {
  verificationNotice.classList.remove('hidden');
  resendBtn.classList.remove('hidden');
  signInBtn.classList.add('hidden');
}

auth.onAuthStateChanged(async (user) => {
  if (user) {
    await user.reload();
    if (user.emailVerified) {
      window.location.href = "index.html";
    } else {
      showUnverifiedState();
      showToast("Please verify your email first", 'warning');
    }
  }
});

signinForm.onsubmit = async (e) => {
  e.preventDefault();
  const email    = signinForm.querySelector('#signinEmail').value.trim();
  const password = signinForm.querySelector('#signinPassword').value;

  try {
    const cred = await auth.signInWithEmailAndPassword(email, password);
    await cred.user.reload();
    if (!cred.user.emailVerified) {
      showUnverifiedState();
      showToast("Please verify your email first", 'warning');
    } else {
      window.location.href = "index.html";
    }
  } catch (err) {
    let msg = "Login failed";
    switch(err.code) {
      case 'auth/user-not-found':
      case 'auth/wrong-password': msg = "Incorrect email or password"; break;
      case 'auth/invalid-email':  msg = "Invalid email format"; break;
      case 'auth/too-many-requests': msg = "Too many attempts. Try again later"; break;
      default: msg = err.message;
    }
    showToast(msg, 'error');
  }
};

resendBtn.onclick = async () => {
  const user = auth.currentUser;
  if (user) {
    resendBtn.disabled = true;
    resendBtn.textContent = "Sending...";
    await sendVerificationEmail(user);
    setTimeout(() => {
      resendBtn.disabled = false;
      resendBtn.textContent = "Resend Verification Email";
    }, 2000);
  }
};

signupForm.onsubmit = async (e) => {
  e.preventDefault();
  const name     = signupForm.querySelector('#signupName').value.trim();
  const email    = signupForm.querySelector('#signupEmail').value.trim();
  const password = signupForm.querySelector('#signupPassword').value;

  if (!name) return showToast("Please enter your name", 'error');
  if (password.length < 6) return showToast("Password must be at least 6 characters", 'error');

  try {
    const cred = await auth.createUserWithEmailAndPassword(email, password);
    await cred.user.updateProfile({ displayName: name });
    await sendVerificationEmail(cred.user);
    
    signupForm.innerHTML = `
      <div style="background:rgba(0,200,83,0.15); border-left:4px solid var(--success); padding:1.2rem; border-radius:8px; margin:1.5rem 0;">
        <strong>Account created successfully!</strong><br><br>
        We sent a verification email to <strong>${email}</strong>.<br>
        Please check your inbox (including spam) and click the link.<br><br>
        After verification, you can <a href="#" id="goToSignIn" style="color:var(--accent);">sign in here</a>.
      </div>
    `;
    $('goToSignIn').onclick = e => { e.preventDefault(); showSignIn(); };
  } catch (err) {
    let msg = "Failed to create account";
    switch(err.code) {
      case 'auth/email-already-in-use': msg = "Email already registered"; break;
      case 'auth/invalid-email':        msg = "Invalid email format"; break;
      case 'auth/weak-password':        msg = "Password is too weak"; break;
      default: msg = err.message;
    }
    showToast(msg, 'error');
  }
};

async function handleGoogleAuth() {
  try {
    await auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());
  } catch (err) {
    if (err.code !== 'auth/popup-closed-by-user') {
      showToast("Google sign-in failed", 'error');
    }
  }
}

googleSignIn.onclick = handleGoogleAuth;
googleSignup.onclick = handleGoogleAuth;

// Start
showSignIn();
</script>
</body>
</html>
