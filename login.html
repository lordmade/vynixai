<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="format-detection" content="telephone=no">
  <title>Vynix Max • Stream Limitless</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Symbols+Rounded" rel="stylesheet"/>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <style>
    :root {
      --primary: #E50914;
      --primary-hover: #f40612;
      --bg: #000000;
      --surface: rgba(22, 22, 22, 0.75);
      --glass-border: rgba(255, 255, 255, 0.12);
      --text: #ffffff;
      --text-muted: #bbbbbb;
      --error: #e87c03;
      --success: #2e7d32;
      --font-main: 'Inter', sans-serif;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
    }
    input, textarea, [contenteditable="true"] {
      user-select: text;
    }
    html, body {
      width: 100%;
      height: 100%;
      background-color: var(--bg);
      color: var(--text);
      font-family: var(--font-main);
      overflow-x: hidden;
      touch-action: manipulation;
    }
    .hero-background {
      position: fixed;
      inset: 0;
      z-index: -1;
    }
    .hero-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0.55;
      filter: brightness(0.85);
    }
    .hero-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to bottom, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0.85) 70%);
    }
    .navbar {
      padding: 1.5rem 4%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      z-index: 10;
    }
    .brand-logo {
      font-size: 2.6rem;
      font-weight: 900;
      color: var(--primary);
      letter-spacing: -2px;
      text-shadow: 0 2px 12px rgba(229,9,20,0.5);
      text-decoration: none;
    }
    .main-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem 1rem;
    }
    .auth-card {
      background: var(--surface);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      padding: 3rem 2.5rem;                  /* slightly more compact */
      width: 100%;
      max-width: 440px;
      box-shadow: 0 20px 70px rgba(0,0,0,0.7);
      position: relative;
      overflow: hidden;
    }
    .auth-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; width: 100%; height: 3px;
      background: linear-gradient(90deg, transparent, var(--primary), transparent);
    }
    h1 {
      font-size: 2.1rem;
      font-weight: 700;
      margin-bottom: 0.6rem;
      color: white;
    }
    .subtitle {
      color: var(--text-muted);
      margin-bottom: 2rem;
      font-size: 0.95rem;
    }
    .input-group {
      position: relative;
      margin-bottom: 1.4rem;
    }
    .input-field {
      width: 100%;
      padding: 1.3rem 1rem 0.5rem;
      background: rgba(50,50,50,0.6);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      color: white;
      font-size: 1rem;
      outline: none;
      transition: all 0.25s;
    }
    .input-field:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(229,9,20,0.2);
    }
    .input-label {
      position: absolute;
      left: 1rem;
      top: 1.1rem;
      color: #aaa;
      font-size: 1rem;
      pointer-events: none;
      transition: all 0.25s ease;
    }
    .input-field:focus ~ .input-label,
    .input-field:not(:placeholder-shown) ~ .input-label {
      top: 0.5rem;
      font-size: 0.78rem;
      color: var(--primary);
      font-weight: 600;
    }
    .toggle-password {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #aaa;
      cursor: pointer;
      font-size: 1.3rem;
    }
    .btn-primary {
      width: 100%;
      padding: 1.1rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1.05rem;
      font-weight: 600;
      margin-top: 1.4rem;
      cursor: pointer;
      transition: all 0.25s;
    }
    .btn-primary:hover:not(:disabled) {
      background: var(--primary-hover);
      transform: translateY(-2px);
    }
    .btn-google {
      width: 100%;
      padding: 1rem;
      background: white;
      color: #111;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-top: 1rem;
    }
    .divider {
      display: flex;
      align-items: center;
      text-align: center;
      margin: 1.6rem 0;
      color: var(--text-muted);
      font-size: 0.9rem;
    }
    .divider::before, .divider::after {
      content: '';
      flex: 1;
      border-bottom: 1px solid #444;
    }
    .links-area {
      margin-top: 1.6rem;
      text-align: center;
      color: var(--text-muted);
      font-size: 0.95rem;
    }
    .text-link {
      color: white;
      text-decoration: none;
      font-weight: 500;
    }
    .text-link:hover { text-decoration: underline; }
    .promo-pill {
      position: absolute;
      top: -14px;
      right: -12px;
      background: linear-gradient(135deg, #ffd700, #ffaa00);
      color: #000;
      padding: 0.45rem 1.1rem;
      border-radius: 50px;
      font-weight: 800;
      font-size: 0.85rem;
      box-shadow: 0 4px 16px rgba(255,170,0,0.5);
      transform: rotate(8deg);
      z-index: 2;
    }
    .hidden { display: none !important; }
    @media (max-width: 600px) {
      .auth-card {
        padding: 2.5rem 1.8rem;
        max-width: 94%;
      }
      h1 { font-size: 1.9rem; }
      .brand-logo { font-size: 2.2rem; }
    }
  </style>
</head>
<body>
  <!-- Hero Background Image -->
  <div class="hero-background">
    <img class="hero-image" alt="Cinematic Streaming Background" 
         src="https://images.unsplash.com/photo-1574375927938-d5a98e8efe85?q=80&w=2069&auto=format&fit=crop">
    <div class="hero-overlay"></div>
  </div>

  <nav class="navbar">
    <a href="#" class="brand-logo">VYNIX MAX</a>
  </nav>

  <main class="main-container">
    <div class="auth-card">
      <div class="promo-pill">R39 / MO</div>

      <!-- Sign In View -->
      <div id="signinView">
        <h1>Sign In</h1>
        <p class="subtitle">Welcome back to limitless streaming.</p>

        <div id="verificationNotice" class="info-box hidden">
          <strong>Verify your email</strong><br>
          We sent a link to your inbox. Check spam folder too.
        </div>

        <form id="signinForm">
          <div class="input-group">
            <input type="email" id="signinEmail" class="input-field" placeholder=" " required autofocus />
            <label for="signinEmail" class="input-label">Email Address</label>
          </div>
          <div class="input-group">
            <input type="password" id="signinPassword" class="input-field" placeholder=" " required />
            <label for="signinPassword" class="input-label">Password</label>
            <button type="button" class="toggle-password material-symbols-rounded" data-target="signinPassword">visibility</button>
          </div>
          <a class="forgot-link" id="forgotPasswordLink">Forgot password?</a>
          <button type="submit" class="btn-primary" id="signInBtn">
            <span>Sign In</span>
          </button>
        </form>

        <button id="resendVerificationBtn" class="btn-primary hidden" style="background:transparent; border:1px solid var(--primary); margin-top:12px;">
          Resend Verification Email
        </button>

        <div class="divider">OR</div>
        <button type="button" class="btn-google" id="googleSignInBtn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" width="20">
          Sign in with Google
        </button>

        <div class="links-area">
          New to Vynix Max? <a href="#" id="switchToSignup" class="text-link">Sign up now</a>
        </div>
      </div>

      <!-- Sign Up View -->
      <div id="signupView" class="hidden">
        <h1>Create Account</h1>
        <p class="subtitle">Join limitless streaming today.</p>

        <form id="signupForm">
          <div class="input-group">
            <input type="text" id="signupName" class="input-field" placeholder=" " required />
            <label for="signupName" class="input-label">Full Name</label>
          </div>
          <div class="input-group">
            <input type="email" id="signupEmail" class="input-field" placeholder=" " required />
            <label for="signupEmail" class="input-label">Email Address</label>
          </div>
          <div class="input-group">
            <input type="password" id="signupPassword" class="input-field" placeholder=" " required minlength="6"/>
            <label for="signupPassword" class="input-label">Password (6+ characters)</label>
            <button type="button" class="toggle-password material-symbols-rounded" data-target="signupPassword">visibility</button>
          </div>
          <button type="submit" class="btn-primary" id="signUpBtn">
            <span>Start Membership</span>
          </button>
        </form>

        <div class="divider">OR</div>
        <button type="button" class="btn-google" id="googleSignupBtn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" width="20">
          Sign up with Google
        </button>

        <div class="links-area">
          Already have an account? <a href="#" id="switchToSignin" class="text-link">Sign in</a>
        </div>
      </div>
    </div>
  </main>

  <!-- Forgot Password Modal -->
  <div id="forgotModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Reset Password</h2>
        <button class="close-btn" id="closeModal">×</button>
      </div>
      <p style="color:#aaa; margin-bottom:1.5rem;">Enter your email to receive a reset link.</p>
      <form id="resetForm">
        <div class="input-group">
          <input type="email" id="resetEmail" class="input-field" placeholder=" " required />
          <label for="resetEmail" class="input-label">Email Address</label>
        </div>
        <button type="submit" class="btn-primary" id="sendResetBtn">
          <span>Send Reset Link</span>
        </button>
      </form>
    </div>
  </div>

  <div class="toast-container" id="toastContainer"></div>

  <script>
    // ==================== CONFIG ====================
    const firebaseConfig = {
      apiKey: "AIzaSyBOyZ3As4GTuNvjemvPF_SpsC6m6vqtNhc",
      authDomain: "fire-b-a8878.firebaseapp.com",
      databaseURL: "https://fire-b-a8878.firebaseio.com",
      projectId: "fire-b-a8878",
      appId: "1:658673187627:web:6e4c29af661785f0afa36e"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const TARGET_PAGE = "index.html"; // ← Change to your dashboard/home page

    // ==================== HELPERS ====================
    function $(id) { return document.getElementById(id); }
    function showToast(message, type = 'info') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.innerHTML = `<span>${message}</span>`;
      $('toastContainer').appendChild(toast);
      setTimeout(() => toast.classList.add('show'), 100);
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 500);
      }, 5200);
    }
    function setLoading(btn, isLoading) {
      btn.disabled = isLoading;
      btn.style.opacity = isLoading ? '0.7' : '1';
      const span = btn.querySelector('span');
      if (span) span.textContent = isLoading ? 'Processing...' : (span.dataset.originalText || 'Sign In');
    }

    // ==================== DOM Elements ====================
    const signinView = $('signinView');
    const signupView = $('signupView');
    const signinForm = $('signinForm');
    const signupForm = $('signupForm');
    const signInBtn = $('signInBtn');
    const signUpBtn = $('signUpBtn');
    const googleSignIn = $('googleSignInBtn');
    const googleSignup = $('googleSignupBtn');
    const switchToSignup = $('switchToSignup');
    const switchToSignin = $('switchToSignin');
    const resendBtn = $('resendVerificationBtn');
    const verificationNotice = $('verificationNotice');
    const forgotModal = $('forgotModal');
    const closeModal = $('closeModal');
    const resetForm = $('resetForm');
    const sendResetBtn = $('sendResetBtn');
    const resetEmail = $('resetEmail');
    const forgotLink = $('forgotPasswordLink');

    signInBtn.querySelector('span').dataset.originalText = 'Sign In';

    // ==================== UI TOGGLES ====================
    function showSignIn() { signinView.classList.remove('hidden'); signupView.classList.add('hidden'); }
    function showSignUp() { signupView.classList.remove('hidden'); signinView.classList.add('hidden'); }
    switchToSignup.onclick = e => { e.preventDefault(); showSignUp(); };
    switchToSignin.onclick = e => { e.preventDefault(); showSignIn(); };
    forgotLink.onclick = () => { forgotModal.style.display = 'flex'; resetEmail.focus(); };
    closeModal.onclick = () => forgotModal.style.display = 'none';
    forgotModal.onclick = e => { if (e.target === forgotModal) forgotModal.style.display = 'none'; };

    // Password visibility toggle
    document.querySelectorAll('.toggle-password').forEach(btn => {
      btn.onclick = () => {
        const input = $(btn.dataset.target);
        input.type = input.type === 'password' ? 'text' : 'password';
        btn.textContent = input.type === 'password' ? 'visibility' : 'visibility_off';
      };
    });

    // ==================== REDIRECT HELPER ====================
    function redirectAfterSuccess() {
      showToast("Success! Redirecting...", 'success');
      setTimeout(() => window.location.href = TARGET_PAGE, 1400);
    }

    // ==================== PASSWORD RESET ====================
    resetForm.onsubmit = async (e) => {
      e.preventDefault();
      const email = resetEmail.value.trim();
      if (!email) return showToast("Please enter your email", 'error');
      setLoading(sendResetBtn, true);
      try {
        await auth.sendPasswordResetEmail(email);
        showToast("Reset link sent! Check your inbox.", 'success');
        forgotModal.style.display = 'none';
        resetEmail.value = '';
      } catch (err) {
        let msg = "Failed to send reset email";
        switch(err.code) {
          case 'auth/invalid-email': msg = "Invalid email format"; break;
          case 'auth/user-not-found': msg = "No account found with this email"; break;
          default: msg = err.message;
        }
        showToast(msg, 'error');
      } finally {
        setLoading(sendResetBtn, false);
      }
    };

    // ==================== EMAIL VERIFICATION & AUTH ====================
    async function sendVerificationEmail(user) {
      try {
        if (!user.emailVerified) {
          await user.sendEmailVerification();
          showToast("Verification email sent! Check your inbox.", 'success');
        }
      } catch (err) {
        showToast("Failed to send verification email.", 'error');
      }
    }

    function showUnverifiedState() {
      verificationNotice.classList.remove('hidden');
      resendBtn.classList.remove('hidden');
      signInBtn.classList.add('hidden');
    }

    // ==================== SIGN IN ====================
    signinForm.onsubmit = async (e) => {
      e.preventDefault();
      const email = $('signinEmail').value.trim();
      const password = $('signinPassword').value;
      try {
        setLoading(signInBtn, true);
        const cred = await auth.signInWithEmailAndPassword(email, password);
        await cred.user.reload();
        if (!cred.user.emailVerified) {
          showUnverifiedState();
          showToast("Please verify your email first", 'warning');
        } else {
          redirectAfterSuccess();
        }
      } catch (err) {
        let msg = "Login failed";
        switch(err.code) {
          case 'auth/user-not-found':
          case 'auth/wrong-password': msg = "Incorrect email or password"; break;
          case 'auth/invalid-email': msg = "Invalid email format"; break;
          case 'auth/too-many-requests': msg = "Too many attempts. Try again later"; break;
          default: msg = err.message;
        }
        showToast(msg, 'error');
      } finally {
        setLoading(signInBtn, false);
      }
    };

    // ==================== SIGN UP ====================
    signupForm.onsubmit = async (e) => {
      e.preventDefault();
      const name = $('signupName').value.trim();
      const email = $('signupEmail').value.trim();
      const password = $('signupPassword').value;
      if (!name) return showToast("Please enter your name", 'error');
      if (password.length < 6) return showToast("Password must be at least 6 characters", 'error');
      try {
        const cred = await auth.createUserWithEmailAndPassword(email, password);
        await cred.user.updateProfile({ displayName: name });
        await sendVerificationEmail(cred.user);
        signupForm.innerHTML = `
          <div style="background:rgba(46,125,50,0.2); border:1px solid var(--success); color:#fff; padding:1.5rem; border-radius:8px; text-align:center;">
            <strong>Account created!</strong><br><br>
            We sent a verification email to <strong>${email}</strong>.<br>
            Please check your inbox (including spam).<br><br>
            <a href="#" id="goToSignIn" style="color:white; text-decoration:underline;">Sign in here</a> after verifying.
          </div>
        `;
        $('goToSignIn').onclick = e => { e.preventDefault(); showSignIn(); };
      } catch (err) {
        let msg = "Failed to create account";
        switch(err.code) {
          case 'auth/email-already-in-use': msg = "Email already registered"; break;
          case 'auth/invalid-email': msg = "Invalid email format"; break;
          case 'auth/weak-password': msg = "Password is too weak"; break;
          default: msg = err.message;
        }
        showToast(msg, 'error');
      }
    };

    // ==================== GOOGLE AUTH ====================
    async function handleGoogleAuth() {
      try {
        await auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());
        redirectAfterSuccess();
      } catch (err) {
        if (err.code !== 'auth/popup-closed-by-user') {
          showToast("Google sign-in failed: " + (err.message || 'Unknown error'), 'error');
        }
      }
    }
    googleSignIn.onclick = handleGoogleAuth;
    googleSignup.onclick = handleGoogleAuth;

    // ==================== RESEND VERIFICATION ====================
    resendBtn.onclick = async () => {
      const user = auth.currentUser;
      if (user) {
        resendBtn.disabled = true;
        resendBtn.textContent = "Sending...";
        await sendVerificationEmail(user);
        setTimeout(() => {
          resendBtn.disabled = false;
          resendBtn.textContent = "Resend Verification Email";
        }, 2500);
      }
    };

    // ==================== START ====================
    showSignIn();
  </script>
</body>
</html>
